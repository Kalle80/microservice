general:
  whitelist: true
  pipeline_base_name: Zuul
#  dependency:
#   - Pipeline X [Stage X]
#   - Pipeline Y [Stage Y]
  
#pre_stage:
#  go_cd_agent_props:
#    - java:8
#    - leiningen
#  custom_cmd:
#    - lein -v
#    - true
  
compile:
  go_cd_agent_props:
    - java:8
    - maven
  sonarqube: true
  stages: # list of stages in order
    - stage: Maven
      jobs:
        - job: CompileJob
          build_path: .
          run_if_conditions: passed
          tasks: # ordered list of tasks to execute in job Maven build
            - task: mvn clean -Djava.security.egd=file:/dev/./urandom install
            - task: docker build -f Dockerfile -t zuul:$GO_PIPELINE_COUNTER .
    - stage: Dockerbuild
      jobs:
        - job: Dokcerbuildeka
          build_path: .
          run_if_conditions: failed
          tasks: # ordered list of tasks to execute in job Docker_build_eka
            - task: true
            - task: true
        - job: Dockerbuildtoka
          tasks: # ordered list of tasks to execute in job Docker_build_toke
            - task: true
            - task: true
  
#post_stage:
#  go_cd_agent_props:
#    - java:7
#    - android
#  custom_cmd:
#    - gradle -v
#    - android --help
  
#post_stage:
#  go_cd_agent_props:
#    - python:3.5
#  custom_cmd:
#    - python -V
  